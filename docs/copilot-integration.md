# GitHub Copilot Integration Guide

SupremePower integrates with GitHub Copilot using a **Dynamic Context Bridge**. Instead of relying on static instruction files that try to cover every possibility, the Active Engine generates specific, time-relevant instructions based on your current workflow step.

## Architecture: Base + Delta

To get the best results, we recommend a two-file setup in your `.github/` directory:

1.  **Base Instructions** (`copilot-instructions.md`): Static, global rules.
2.  **Active Context** (`supremepower-active.md`): Dynamic, step-specific instructions.

### 1. Base Instructions (Static)

Create `.github/copilot-instructions.md` with your project's immutable rules:

```markdown
# Project Instructions

## Code Style
- Use TypeScript with strict mode.
- Prefer functional patterns.
- Use 2 spaces for indentation.

## Workflow Rules
- Always check `.github/supremepower-active.md` for the current task context.
- If the Active Context says "RED PHASE", do NOT write implementation code. Only write tests.
```

### 2. Active Context (Dynamic)

**Do not edit this file manually.** The SupremePower Active Engine (via VS Code Extension or CLI) manages it.

It typically looks like this:

```markdown
# SupremePower Active State
**Current Phase:** RED_PHASE
**Active Agents:** security-engineer, testing-specialist

## Instructions for Current Step
Write one minimal test showing what should happen.

<Good>
test('retries failed operations 3 times', async () => { ... })
</Good>

**Requirements:**
- One behavior
- Clear name
- Real code (no mocks unless unavoidable)
```

## How It Works

1.  **You Start a Skill:** You use `@supremepower start tdd` in Chat, click "Start Skill" in the VS Code Sidebar, or run a CLI command.
2.  **State Update:** The engine initializes the session and sets the step to "RED".
3.  **Context Bridge:** The VS Code Extension (or CLI) reads the TDD skill, extracts the "RED" step instructions, and writes them to `.github/supremepower-active.md`.
4.  **Copilot Reads:** When you type in your editor, Copilot reads `copilot-instructions.md`, which tells it to look at `supremepower-active.md`.
5.  **Context Injection:** Copilot sees "Current Phase: RED" and the specific examples for writing good tests. It adapts its suggestions accordingly.

## Troubleshooting

### Copilot Ignoring Context?
- **Check File Location:** Ensure `.github/supremepower-active.md` exists in the workspace root.
- **Check References:** GitHub Copilot automatically indexes `.github/` files, but adding an explicit reference in `copilot-instructions.md` helps reinforcement.
- **Check File Size:** If instructions are too long (> 2KB), Copilot might truncate them. The Active Engine tries to keep deltas focused.

### "File Changed" Warnings
You might see VS Code warnings that `.github/supremepower-active.md` has changed on disk. This is normal behavior as the engine updates the state. You can configure VS Code to auto-reload:

```json
"files.autoReload": {
    "enable": true
}
```
